fid(s),is_no_add,is_med_action,dbtable,select_cols,where_conditions,transform_func_id,assert
bnp,yes,no,"""Labs""","""BASE_NAME"", ""RESULT_TIME"", ""ResultValue""","where ""COMPONENT_ID""  = ANY('{8100004188, 9000000516, 9700000141, 4000001279, 8100000292, 7000002083, 3000001261, 4000000283, 8200003476, 970000223, 9000000586, 4000000593, 2000001245}');",,
labetalol,yes,no,"""FlowsheetValue""","""FLO_MEAS_NAME"", ""TimeTaken"", ""Value""","where ""FLO_MEAS_ID"" = '3040101268'",,
height,yes,no,"""FlowsheetValue_643""","""FLO_MEAS_NAME"", ""TimeTaken"", ""Value""","where ""FLO_MEAS_NAME"" ilike 'HEIGHT' and ""Value"" is not Null and ""Value""::float between 22 and 108",convert_inch_to_cm,
bmi,yes,no,"""FlowsheetValue_643""","""FLO_MEAS_NAME"", ""TimeTaken"", ""Value""","where ""FLO_MEAS_NAME"" ilike '%BMI%'",,
acute_heart_failure_icd9_diag,yes,no,"""Diagnoses""","""Code""","where ""Code"" like any ('{ ""402.01%"", ""402.11%"", ""402.91%"", ""425.1%"", ""425.4%"", ""425.5%"", ""425.7%"", ""425.8%"", ""425.9%"", ""428.0%"", ""428.1%"", ""428.2%"", ""428.21%"", ""428.22%"", ""428.23%"", ""428.3%"", ""428.31%"", ""428.32%"", ""428.33%"", ""428.4%"", ""428.41%"", ""428.42%"", ""428.43%"", ""428.9%""}')",,
acute_heart_failure_icd9_hist,yes,no,"""MedicalHistory""","""Code""","where ""Code"" like any ('{ ""402.01%"", ""402.11%"", ""402.91%"", ""425.1%"", ""425.4%"", ""425.5%"", ""425.7%"", ""425.8%"", ""425.9%"", ""428.0%"", ""428.1%"", ""428.2%"", ""428.21%"", ""428.22%"", ""428.23%"", ""428.3%"", ""428.31%"", ""428.32%"", ""428.33%"", ""428.4%"", ""428.41%"", ""428.42%"", ""428.43%"", ""428.9%""}')",,
acute_heart_failure_icd9_prob,yes,no,"""ProblemList""","""csn_id"" visit_id, code","where code like any ('{ ""402.01%"", ""402.11%"", ""402.91%"", ""425.1%"", ""425.4%"", ""425.5%"", ""425.7%"", ""425.8%"", ""425.9%"", ""428.0%"", ""428.1%"", ""428.2%"", ""428.21%"", ""428.22%"", ""428.23%"", ""428.3%"", ""428.31%"", ""428.32%"", ""428.33%"", ""428.4%"", ""428.41%"", ""428.42%"", ""428.43%"", ""428.9%""}')",,
isosorbide_dinitrate_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""",where display_name ilike '%isosorbide dinitrate%',convert_to_mg,
losartan_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""",where display_name ilike '%losartan%',convert_to_mg,
valsartan_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""", where display_name ilike '%valsartan%' and display_name not ilike '%acubitril%' ,convert_to_mg,
sacubitril_valsartan_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""",where display_name ilike '%sacubitril_valsartan%',convert_to_mg,
furosemide_IV_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","where display_name ilike '%furosemide%' and ""MedRoute"" = 'Intravenous'",convert_to_mg,
mech_cardiac_support_device,yes,no,"""OrderProcs_643""","""CSN_ID"" visit_id,""PROC_START_TIME"", ""PROC_ENDING_TIME""",where display_name ilike '%iabp%',convert_proc_to_boolean,
mech_cardiac_support_device,yes,no,"""OrderProcs""","""CSN_ID"" visit_id,""PROC_START_TIME"", ""PROC_ENDING_TIME""",where display_name ilike '%iabp%',convert_proc_to_boolean,
mech_cardiac_support_device_surgery,yes,no,"""surgery_info""","csn_id as visit_id, case_begin_instant, case_end_instant, sched_status_c, enter_or_room_instant as tsp, enter_or_room_instant,  leave_or_room_instant, scheduled_yn, preformed_yn,
procedure_name, procedure_display_name",where procedure_name ilike '%IABP%' and preformed_yn = 'Y',convert_surgery_to_json,
norepinephrine_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","WHERE ""display_name"" ILIKE '%norepinephrine%' AND NOT ""display_name"" ILIKE ANY ('{""%gel%"",""%vaginal%"",""%cream%"",""%ophthalmic%"",""%ointment%"",""%nebulizer%"",""%drop%""}')",convert_to_mcg_kg_min,
lactulose_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","WHERE ""display_name"" ILIKE 'lactulose%' AND NOT ""display_name"" ILIKE ANY ('{""%gel%"",""%vaginal%"",""%cream%"",""%ophthalmic%"",""%ointment%"",""%nebulizer%"",""%drop%""}')",convert_to_mg,
protamine_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","WHERE ""display_name"" ILIKE 'protamine%' AND NOT ""display_name"" ILIKE ANY ('{""%gel%"",""%vaginal%"",""%cream%"",""%ophthalmic%"",""%ointment%"",""%nebulizer%"",""%drop%""}')",convert_to_mg,
phytonadione_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","WHERE ""display_name"" ILIKE 'phytonadione%' AND NOT ""display_name"" ILIKE ANY ('{""%gel%"",""%vaginal%"",""%cream%"",""%ophthalmic%"",""%ointment%"",""%nebulizer%"",""%drop%""}')",convert_to_mg,
flumazenil_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","WHERE ""display_name"" ILIKE 'flumazenil%' AND NOT ""display_name"" ILIKE ANY ('{""%gel%"",""%vaginal%"",""%cream%"",""%ophthalmic%"",""%ointment%"",""%nebulizer%"",""%drop%""}')",convert_to_mg,
metoprolol_IV_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","where display_name ilike '%metoprolol%' and ""MedRoute"" = 'Intravenous'",convert_to_mg,
nitroglycerin_IV_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","where display_name ilike '%nitroglycerin%' and ""MedRoute"" = 'Intravenous'",convert_to_mcg_min,
nitroglycerin_sub_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","where display_name ilike '%nitroglycerin%' and ""MedRoute"" ilike 'sublingual'",convert_to_mg,
aspirin_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","where display_name ilike 'aspirin%' AND NOT ""display_name"" ILIKE ANY ('{""%gel%"",""%vaginal%"",""%cream%"",""%ophthalmic%"",""%ointment%"",""%nebulizer%"",""%drop%""}')",convert_to_mg,
lorazepam_IM_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","where display_name ilike '%lorazepam%' and ""MedRoute"" ilike 'intramuscular'",convert_to_mg,
diazepam_IM_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","where display_name ilike '%diazepam%' and ""MedRoute"" ilike 'intramuscular'",convert_to_mg,
phenobarbital_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","where ""display_name"" ilike 'phenobarbital%' AND NOT ""display_name"" ILIKE ANY ('{""%gel%"",""%vaginal%"",""%cream%"",""%ophthalmic%"",""%ointment%"",""%nebulizer%"",""%drop%""}')",convert_to_mg,
tsh,yes,no,"""Labs""","""BASE_NAME"", ""RESULT_TIME"", ""ResultValue"", ""REFERENCE_UNIT""","WHERE ""BASE_NAME"" = 'TSH'",convert_lab_value_to_real,
lymph_abs,yes,no,"""Labs""","""BASE_NAME"", ""RESULT_TIME"", ""ResultValue"", ""REFERENCE_UNIT""","WHERE ""BASE_NAME"" = 'LYMPHOABS'",convert_lymph_abs_to_real,
albumin,yes,no,"""Labs""","""BASE_NAME"", ""RESULT_TIME"", ""ResultValue"", ""REFERENCE_UNIT""","WHERE ""BASE_NAME"" = 'ALBUMIN'",convert_lab_value_to_real,
cortisol,yes,no,"""Labs""","""BASE_NAME"", ""RESULT_TIME"", ""ResultValue"", ""REFERENCE_UNIT""","WHERE ""BASE_NAME"" = 'CORTISOL'",convert_lab_value_to_real,
mchc,yes,no,"""Labs""","""BASE_NAME"", ""RESULT_TIME"", ""ResultValue"", ""REFERENCE_UNIT""","WHERE ""BASE_NAME"" = 'MCHC'",convert_lab_value_to_real,
buprenorphine-naloxone_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","where display_name  ilike  'buprenorphine-naloxone%' AND NOT ""display_name"" ILIKE ANY ('{""%gel%"",""%vaginal%"",""%cream%"",""%ophthalmic%"",""%ointment%"",""%nebulizer%"",""%drop%""}')",convert_to_mg,
naloxone_injection_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","where ""MEDICATION_ID"" = '5373' AND NOT ""display_name"" ILIKE ANY ('{""%gel%"",""%vaginal%"",""%cream%"",""%ophthalmic%"",""%ointment%"",""%nebulizer%"",""%drop%""}')",convert_to_mg,
eeg_proc,yes,no,"""OrderProcs""","""CSN_ID"" visit_id,""display_name"", ""ORDER_TIME"", ""OrderStatus""",where proc_name ilike '%eeg%',convert_proc_to_json,
arterial_blood_gas_proc,yes,no,"""OrderProcs""","""CSN_ID"" visit_id,""display_name"", ""ORDER_TIME"", ""OrderStatus""","where proc_name ilike '%blood gas%' and proc_name ilike '%arterial%' and ""OrderStatus"" != 'Canceled';",convert_proc_to_json,
troponin_proc,yes,no,"""OrderProcs""","""CSN_ID"" visit_id,""display_name"", ""ORDER_TIME"", ""OrderStatus""",where proc_name ilike '%troponin%',convert_proc_to_json,
telemetry_proc,yes,no,"""OrderProcs""","""CSN_ID"" visit_id,""display_name"", ""ORDER_TIME"", ""OrderStatus""",where proc_name ilike '%TELEMETRY MONITORING%',convert_proc_to_json,
glucose,yes,no,"""Labs""","""BASE_NAME"", ""RESULT_TIME"", ""ResultValue"", ""REFERENCE_UNIT""","where ""NAME"" in ('GLUCOSE', 'GLUCOSE, WHOLE BLOOD','NOVA-GLUCOSE,WBLOOD','POC GLUCOSE, BLOOD')",,
e_gfr,yes,no,"""Labs""","""BASE_NAME"", ""RESULT_TIME"", ""ResultValue"", ""REFERENCE_UNIT""","where ""NAME"" ilike '%eGFR%'",convert_lab_value_to_real,
rifaximin_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""",where display_name ilike '%rifaximin%',convert_to_mg,
systemic_steroids_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","WHERE display_name ILIKE ANY('{""%prednisone%"", ""%methylprednisolone%"", ""%prednisolone%"", ""%fludrocortisone%"", ""%hydrocortisone%""}') and not display_name ilike any('{""%gel%"", ""%vaginal%"", ""%cream%"",""%ophthalmic%"", ""%rabbit%"", ""%foam%"", ""%ointment%"", ""%nebulizer%"", ""%drop%"", ""%CORTISPORIN%"", ""%enema%"", ""%mtx%""}')",convert_to_mg,
bumetanide_IV_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT"" ","where display_name ilike '%bumetanide%' and ""MedRoute"" = 'Intravenous' ",convert_to_mg,
sodium_bicarbonate_infu_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","where display_name ilike 'sodium bicarbonate%' and ""MedRoute"" = 'Intravenous' and ""MedUnit"" ilike 'meq'",convert_dose_to_binary,
sodium_bicarbonate_injec_dose,no,yes,"""MedicationAdministration""","""MEDICATION_ID"",""MedRoute"",""display_name"", ""TimeActionTaken"", ""ORDER_INST"", ""ActionTaken"", ""Dose"", ""MedUnit"",""INFUSION_RATE"",""MAR_INF_RATE_UNIT"",""mar_duration"",""MAR_DURATION_UNIT""","where display_name ilike 'sodium bicarbonate%' and ""MedRoute"" = 'Intravenous' and ""MedUnit"" not ilike 'meq'",convert_dose_to_binary,
troponin_i,yes,no,"""Labs""","""BASE_NAME"", ""RESULT_TIME"", ""ResultValue"", ""REFERENCE_UNIT""","WHERE ""BASE_NAME"" ilike '%TROPONINI%'",convert_lab_value_to_real,
troponin_t,yes,no,"""Labs""","""BASE_NAME"", ""RESULT_TIME"", ""ResultValue"", ""REFERENCE_UNIT""","WHERE ""BASE_NAME"" ilike '%TROPONINT%'",convert_lab_value_to_real,
o2_flow_rate,yes,no,"""FlowsheetValue_643""","""FLO_MEAS_NAME"", ""TimeTaken"", ""Value""","where ""FLO_MEAS_NAME"" ilike '%o2%flow%rate%'",,
lvef,,,,,,etl.transforms.pipelines.clarity_2_cdm_pd.pull_lvef,
rvf,,,,,,etl.transforms.pipelines.clarity_2_cdm_pd.pull_rvf,